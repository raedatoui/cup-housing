<html lang="en"><head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Envisioning Development: What is Affordable Housing?</title>

    <style type="text/css">
      body {
        margin: 0;
      }
    </style>


    <script type="text/javascript" src="swfobject.js"></script><style type="text/css"></style>
    <script type="text/javascript">
      function updatePermalink(params) {
        location.href = '#' + (params ? params : '-');
        return true;
      }

      function parseQueryString(qs) {
        var query = {};
        if (qs.length > 0) {
          var parts = qs.split('&');
          for (var i = 0; i < parts.length; i++) {
            var nameValue = parts[i].split('=');
            if (nameValue.length == 2) {
              query[nameValue[0]] = unescape(nameValue[1]);
            }
          }
        }
        return query;
      }
    </script>
  </head>

  <body>
    <div id="swf"></div>

    <script type="text/javascript">

      window.loadJSON = function(path, success, error) {
        var xhr = new XMLHttpRequest();
        xhr.onreadystatechange = function() {
          if (xhr.readyState === XMLHttpRequest.DONE) {
            if (xhr.status === 200) {
              if (success)
                success(JSON.parse(xhr.responseText));
            }
            else {
              if (error)
                error(xhr);
            }
          }
        };
        xhr.open("GET", path, true);
        xhr.send();
      }

      var so = new SWFObject('nyc_cup_housing.swf', 'flash', '100%', '100%', '9.0.0', '#000000');
      so.useExpressInstall('expressinstall.swf');
      so.addParam('allowScriptAccess', 'always');
      so.addParam('allowFullscreen', 'false');
      so.addParam('menu', 'true');

      var flashvars = {};

      flashvars['subboro'] = getQueryParamValue('id'),

      loadJSON('/data/settings.json',
        function(data) {
          console.log(data);
        },
        function(xhr) { console.error(xhr); }
      );

      for (var prop in flashvars)
        so.addVariable(prop, flashvars[prop]);

      so.write('swf');

    </script>
  </div>
</body></html>
